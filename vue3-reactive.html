<script>

  const obj = {
    a: 1,
    b: 2,
    c: 3
  }
  
  let bucket = []
  let effectFn = null
  const proxy = new Proxy(obj, {
    get(target, propKey, receiver) {
      bucket.push(effectFn)
      return target[propKey]
    },
    set(target, propKey, value, receiver) {
      target[propKey] = value
      bucket.forEach(fn => fn())
    }
  })



  function effect(fn) {
    effectFn = fn
    fn()
    effectFn = null
  }

  const fn = () => {
    console.log('更新', proxy.a)
  }

  effect(fn)

  proxy.a = 3


</script>